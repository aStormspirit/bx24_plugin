# Используем образ Node.js для сборки React приложения.
FROM node:alpine as build-stage

# Устанавливаем рабочий каталог внутри контейнера
WORKDIR /app

# Оптимизация кэширования слоев Docker: сначала копируем только файлы с зависимостями.
COPY package.json yarn.lock ./

# Устанавливаем зависимости
RUN yarn install

# Теперь копируем остальные исходные файлы проекта
COPY . .

# Строим приложение
RUN yarn build

# На этом этапе сборка React приложения завершена и файлы находятся в /app/build.
# Используем команду true, так как дальнейшее выполнение этого контейнера не требуется,
# все необходимые файлы уже находятся в volume, который примонтирован к директории /app/build.
CMD ["true"]
